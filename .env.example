# RecDesk AI Backend - Environment Variables
# =============================================
# This file documents all environment variables used by the backend.
# Copy this file to .env and fill in your values.
#
# Environments:
#   - dev: Local development (everything runs on your laptop)
#   - production: Live environment (Railway + Vercel)

# =============================================================================
# APPLICATION
# =============================================================================
# Environment: development | production
NODE_ENV=development
PORT=3000
API_PREFIX=api

# Frontend URL (for CORS and redirects)
# dev: http://localhost:3001
# production: https://recdesk.io
FRONTEND_URL=http://localhost:3001

# =============================================================================
# DATABASE (PostgreSQL)
# =============================================================================
# dev: Local PostgreSQL
# production: Railway PostgreSQL (auto-generated DATABASE_URL)
DATABASE_URL="postgresql://postgres:password@localhost:5432/recdesk?schema=public&connection_limit=10&pool_timeout=20"

# =============================================================================
# REDIS (Caching & Queues)
# =============================================================================
# Redis is OPTIONAL - the app gracefully falls back to in-memory cache when not configured.
#
# Local Development:
#   Start Redis with: docker-compose up -d
#   Then set REDIS_HOST=localhost
#
# Production (Railway):
#   1. Add Redis addon in Railway dashboard
#   2. Railway auto-injects REDIS_URL (no manual config needed)
#
# Choose ONE of these options:
# Option A: Use REDIS_URL (preferred for Railway/cloud)
# REDIS_URL=redis://default:password@host:port
#
# Option B: Use individual settings (for local Docker)
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=

# =============================================================================
# JWT AUTHENTICATION
# =============================================================================
# CRITICAL: Use a strong secret in production!
# Generate with: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d

# Password Hashing
BCRYPT_SALT_ROUNDS=10

# =============================================================================
# AWS S3 (File Storage)
# =============================================================================
# dev: recdesk-cvs-dev (or use local fallback)
# production: recdesk-cvs-prod
AWS_REGION=eu-central-1
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_S3_BUCKET=recdesk-cvs-dev

# Set to 'true' to use local file storage instead of S3 (for dev without AWS)
S3_USE_LOCAL_FALLBACK=true

# =============================================================================
# AI PROVIDER (Groq for beta phase)
# =============================================================================
# Provider: groq (cost-effective) or openai (higher accuracy)
AI_PROVIDER=groq
GROQ_API_KEY=your-groq-api-key
GROQ_MODEL=llama-3.3-70b-versatile

# OpenAI (optional, for production if needed later)
OPENAI_API_KEY=your-openai-api-key

# =============================================================================
# EMAIL SERVICE (SendGrid)
# =============================================================================
SENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=noreply@recdesk.io

# =============================================================================
# GMAIL OAUTH (Email Integration)
# =============================================================================
# Redirect URIs:
#   dev: http://localhost:3000/api/integrations/gmail/callback
#   production: https://api.recdesk.io/api/integrations/gmail/callback
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:3000/api/integrations/gmail/callback
GOOGLE_PUBSUB_TOPIC=projects/your-project/topics/gmail-notifications

# =============================================================================
# ENCRYPTION
# =============================================================================
# 32-character key for encrypting OAuth tokens
# Generate with: openssl rand -hex 16
ENCRYPTION_KEY=your-32-character-encryption-key!

# =============================================================================
# STRIPE (Billing)
# =============================================================================
# dev: Use test keys (sk_test_xxx)
# production: Use live keys (sk_live_xxx)
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# Stripe Price IDs (create in Stripe Dashboard)
STRIPE_FREE_TRIAL_PRICE_ID=price_free_trial
STRIPE_STARTER_PRICE_ID=price_starter
STRIPE_PROFESSIONAL_PRICE_ID=price_professional
STRIPE_ENTERPRISE_PRICE_ID=price_enterprise

# =============================================================================
# EMAIL PREFILTER (Cost Optimization)
# =============================================================================
# Reduces AI API costs by 50-80% by skipping obvious non-job-application emails
PREFILTER_ENABLED=true
PREFILTER_AUTO_CLASSIFY_ENABLED=true
